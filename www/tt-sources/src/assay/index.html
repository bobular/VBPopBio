[% INCLUDE header.html
   title = 'VectorBase Population Browser - Assay'
   js = [ 'https://ajax.googleapis.com/ajax/libs/prototype/1.7.0.0/prototype.js', 'js/config.js', 
'js/phenovis-0.01.js', 'js/frontend.js' 'js/protovis-d3.2.js' 'https://maps.google.com/maps/api/js?sensor=false' ]
%]

<div id="assay">

  <div class="vbpg_progress"></div>

  <div class="vbpg_object_info assay hide_on_load" id="assay_info">
    <h1><span class="object_value scalar capitalize" id="type"></span>: <span class="object_value scalar" id="name"></span></h1>

    <table>
      <tr>
	<th class="row_heading">VectorBase stable ID</th>
	<td class="object_value scalar" id="id"></td>
      </tr>
      <tr>
	<th class="row_heading">description</th>
	<td class="object_value scalar na_if_empty" id="description"></td>
      </tr>
      <tr>
	<th class="row_heading">performed by</dt>
        <td class="object_value comma_separated na_if_empty" id="performers"></td>
      </tr>
    </table>
    <table class="nested_props_list no_shading">
      <tr class="list_row_template">
        <th class="row_heading prop_type" delimiter=", "></th>
        <td class="prop_value"></td>
      </tr>
    </table>
  
  </div> <!-- assay_info -->

  <!-- Protocols -->
  <div class="vbpg_object_info hide_on_load" id="assay_protocols">
    <h2>Protocols</h2>
    <div class="assay_protocol list_row_template">
      <div class="assay_protocol_name object_value scalar" id="name"></div>
      <table>
        <tr>
          <th class="row_heading">description</th>
          <td class="object_value scalar na_if_empty" id="description"></td>
	  <td class="nested_props_list no_shading" rowspan="3">
	    <table>
              <tr class="protocol_prop list_row_template">
                <th class="prop_type row_heading" delimiter=", "></th>
                <td class="prop_value"></td>
              </tr>
            <table>
        </tr>
        </table>
        </tr>
        <tr>
          <th class="row_heading">type</th>
          <td class="object_value cvterm" id="type"></td>
        </tr>
        <tr>
          <th class="row_heading">external link</th>
          <td><a class="auto_link" href="####"><span class="object_value scalar" id="uri"></span></a></td>
        </tr>
      </table>
    </div>
  </div>

  <!-- Collection site -->
  <div class="vbpg_object_info hide_on_load" id="assay_geolocation_info">
    <h2>Collection site</h2>
    <div id="mini_map_panel"></div>
    <div id="assay_geolocation_text">
      <table>
        <tr>
          <th class="row_heading">name</th>
          <td class="object_value scalar" id="name"></td>
        </tr>
        <tr>
          <th class="row_heading">coordinates</th>
          <td class="object_value clear_if_missing" id="latitude"><a class="auto_link" title="Google Maps (external site)" href="http://maps.google.com/maps?hl=en&tab=wl&z=8&q=####+(Collection+site)"><span class="object_value scalar" id="latitude"></span>,<span class="object_value scalar" id="longitude"></span></a> (<span class="object_value scalar" id="geodetic_datum"></span>)</td>
        </tr>
        <tr>
          <th class="row_heading">altitude</th>
          <td class="object_value scalar" id="altitude"></td>
        </tr>
      </table>
      <table class="nested_props_list no_shading">
        <tr class="list_row_template">
          <th class="row_heading prop_type" delimiter=", "></th>
          <td class="prop_value"></td>
        </tr> 
      </table>
    </div><!-- assay_geolocation_text -->
    <br clear="all"/>
  </div> <!-- assay_geolocation_info -->


  <!-- Phenotypes -->
  <div class="vbpg_object_list hide_on_load" id="assay_phenotypes">
    <h2>Phenotypes</h3>
    <table>
    <tr>
      <th>name</th>
      <th>formal 'ontologised' description</th>
      <th>additional properties</th>
    </tr>
    <tr class="list_row_template">
      <td class="object_value scalar" id="name"></td>
      <td>
        <span class="object_value cvterm linebreak_after" id="observable"></span>
        <span class="object_value cvterm linebreak_after" id="attribute"></span>
        <span class="object_value cvterm" id="value.term"></span>
        <span class="object_value scalar" id="value.text"></span>
        <span class="object_value cvterm" id="value.unit"></span>
      </td>
      <td class="nested_props_list">
        <!-- extra properties -->
        <table>
          <tr class="phenotype_prop list_row_template">
            <th class="prop_type row_heading" delimiter=", "></th>
            <td class="prop_value"></td>
          </tr>
        </table>
      </td>
    </tr>
    </table>
  </div>



  <!-- Genotypes -->
  <div class="vbpg_object_list hide_on_load" id="assay_genotypes">
    <h2>Genotypes</h3>
    <table>
      <tr>
        <th class="row_heading">name</th>
        <th class="row_heading">description</th>
        <th class="row_heading">properties</th>
      </tr>
      <tr class="list_row_template">
        <td class="object_value scalar" id="name"></td>
        <td class="object_value scalar" id="description"></td>
        <td class="nested_props_list" id="props">
          <table>
            <tr class="phenotype_prop list_row_template">
              <th class="prop_type row_heading" delimiter=", "></th>
              <td class="prop_value"></td>
            </tr>
          </table>
        </td>
      </tr>
    </table>
  </div>


[% INCLUDE 'list/samples.html' id='assay_stocks' %]

[% INCLUDE 'list/projects.html' id='assay_projects' title='Assay belongs to these projects' %]

</div> <!-- assay -->
  
<script type="text/javascript">
  params = document.location.search.toQueryParams();
  if (params.id && params.id.match("^VBA[0-9]+$")) {
    var spinner = $('assay').down('.vbpg_progress');
    getObject('assay/'+params.id, spinner, 
              function(assay){ updateAssayFull(assay, $('assay')); }
             );
  } else {
     $('assay').down('div.vbpg_progress').update("Please provide   the <tt>id</tt> URL parameter.").setStyle({ textAlign: 'center', width: '100%', background: 'pink' });
  }
</script>

[% INCLUDE footer.html %]
